<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Calculator</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 50px; 
            background-color: #f4f7f6;
            text-align: center;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: inline-block;
            min-width: 350px;
        }
        input { 
            padding: 12px; 
            margin: 10px 5px; 
            border: 2px solid #ccc;
            border-radius: 4px;
            width: 120px;
            font-size: 16px;
        }
        .operation-buttons {
            margin: 15px 0;
        }
        button { 
            padding: 12px 25px; 
            margin: 5px; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
        }
        .btn-add { background-color: #4CAF50; }
        .btn-add:hover { background-color: #45a049; }
        
        .btn-subtract { background-color: #ff9800; }
        .btn-subtract:hover { background-color: #e68900; }
        
        .btn-multiply { background-color: #2196F3; }
        .btn-multiply:hover { background-color: #0b7dda; }
        
        .btn-divide { background-color: #f44336; }
        .btn-divide:hover { background-color: #da190b; }
        
        .btn-clear { 
            background-color: #607D8B; 
            margin-top: 15px;
        }
        .btn-clear:hover { background-color: #455a64; }
        
        h3 { color: #333; margin-top: 20px; }
        #res { 
            color: #2e7d32; 
            font-weight: bold; 
            font-size: 18px;
            min-height: 30px;
        }
        .input-row {
            margin: 15px 0;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>üßÆ Kubernetes Calculator</h2>
        <div class="input-row">
            <input id="num1" type="number" placeholder="First Number" step="any"> 
            <input id="num2" type="number" placeholder="Second Number" step="any">
        </div>
        
        <div class="operation-buttons">
            <button class="btn-add" onclick="calculate('add')">‚ûï Add</button>
            <button class="btn-subtract" onclick="calculate('subtract')">‚ûñ Subtract</button>
            <br>
            <button class="btn-multiply" onclick="calculate('multiply')">‚úñÔ∏è Multiply</button>
            <button class="btn-divide" onclick="calculate('divide')">‚ûó Divide</button>
        </div>
        
        <h3 id="res">Select an operation</h3>
        <button class="btn-clear" onclick="clearCalculator()">Clear</button>
    </div>

    <script>
    async function calculate(operation) {
        const num1 = document.getElementById('num1').value;
        const num2 = document.getElementById('num2').value;
        const resultDisplay = document.getElementById('res');
        
        // Input validation
        if (!num1 || !num2) {
            resultDisplay.innerText = '‚ö†Ô∏è Please enter both numbers';
            resultDisplay.style.color = '#ff9800';
            return;
        }
        
        // Show loading state
        resultDisplay.innerText = '‚è≥ Calculating...';
        resultDisplay.style.color = '#333';

        try {
            // Backend URL using NodePort 30008
            const backendUrl = `http://${window.location.hostname}:30008/calculate`;
            
            console.log(`Calling ${operation} operation:`, backendUrl);

            const response = await fetch(backendUrl, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    num1: parseFloat(num1), 
                    num2: parseFloat(num2),
                    operation: operation
                })
            });
            
            const data = await response.json();
            
            if (data.status === 'success') {
                // Get operation symbol
                const symbols = {
                    'add': '+',
                    'subtract': '-',
                    'multiply': '√ó',
                    'divide': '√∑'
                };
                
                resultDisplay.innerText = `${num1} ${symbols[operation]} ${num2} = ${data.result}`;
                resultDisplay.style.color = '#4CAF50';
            } else {
                resultDisplay.innerText = '‚ùå Error: ' + data.error;
                resultDisplay.style.color = '#f44336';
            }
        } catch (err) {
            resultDisplay.innerText = '‚ùå Error: Cannot reach backend at port 30008';
            resultDisplay.style.color = '#f44336';
            console.error('Fetch error:', err);
        }
    }
    
    function clearCalculator() {
        document.getElementById('num1').value = '';
        document.getElementById('num2').value = '';
        document.getElementById('res').innerText = 'Select an operation';
        document.getElementById('res').style.color = '#333';
    }
    
    // Allow Enter key to trigger addition
    document.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            calculate('add');
        }
    });
    </script>
</body>
</html>